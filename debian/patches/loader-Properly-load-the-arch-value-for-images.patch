From: =?utf-8?q?Fabiano_Fid=C3=AAncio?= <fidencio@redhat.com>
Date: Wed, 10 Apr 2019 13:45:14 +0200
Subject: loader: Properly load the arch value for images
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: 8bit

osinfo_loader_image() has been considering the XML tag for the
images' architecture was "architecture", while it actually is "arch".

By trying to read the wrong tag, no arch was loaded, causing then any
image load to fail with:
CRITICAL **: 13:30:06.539: osinfo_entity_set_param: assertion 'value != NULL' failed

Signed-off-by: Fabiano FidÃªncio <fidencio@redhat.com>
---
 osinfo/osinfo_loader.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/osinfo/osinfo_loader.c b/osinfo/osinfo_loader.c
index 95d4424..8f2f477 100644
--- a/osinfo/osinfo_loader.c
+++ b/osinfo/osinfo_loader.c
@@ -1297,8 +1297,7 @@ static OsinfoImage *osinfo_loader_image(OsinfoLoader *loader,
         { NULL, G_TYPE_INVALID }
     };
 
-    gchar *arch = (gchar *)xmlGetProp(root,
-                                      BAD_CAST OSINFO_IMAGE_PROP_ARCHITECTURE);
+    gchar *arch = (gchar *)xmlGetProp(root, BAD_CAST "arch");
     gchar *format = (gchar *)xmlGetProp(root,
                                         BAD_CAST OSINFO_IMAGE_PROP_FORMAT);
     gchar *cloud_init = (gchar *)xmlGetProp(root,
